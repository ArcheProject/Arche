<div tal:define="oid oid|field.oid;
                 name name|field.name;"
    xmlns:i18n="http://xml.zope.org/namespaces/i18n"
    i18n:domain="Arche"
    tal:omit-tag="">

<div id="ql-editor-${oid}" name="${name}" tal:content="structure cstruct"/>
<textarea class="hidden" id="ql-result-${oid}" name="${name}" tal:content="structure cstruct"/>
<script>
  (function($){
    var editor,
        $result = $('#ql-result-${oid}');
    deform.addCallback('${oid}', function (oid) {
      var toolbarOptions = [
        ['bold', 'italic', 'underline', 'strike'],        // toggled buttons
        ['blockquote', 'code-block'],

        [{ 'list': 'ordered'}, { 'list': 'bullet' }],
        [{ 'script': 'sub'}, { 'script': 'super' }],      // superscript/subscript
        [{ 'direction': 'rtl' }],                         // text direction

        [{ 'header': [1, 2, 3, 4, 5, 6, false] }],
        ['clean']
      ]
      var options = {
        modules: { toolbar: toolbarOptions },
        theme: '${field.widget.theme}',
        placeholder: '${field.widget.placeholder}',
        readOnly: ${field.widget.readonly and "true" or "false"},
      };
      editor = new Quill('#ql-editor-${oid}', options);
      editor.on('text-change', function() {
        $result.html(editor.root.innerHTML);
      });
    });
  })(jQuery);
</script>

</div>
