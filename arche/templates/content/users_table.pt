<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      metal:use-macro="view.macro('arche:templates/base_view.pt')"
      i18n:domain="Arche">
<body>
<div metal:fill-slot="main-content">

  <script type="text/javascript">
    $(document).ready(function() {
      var request = arche.do_request("${request.resource_url(context, 'users.json')}");
      request.done(function(response) {
        $('[data-load-marker]').remove();
        var directive = {'tr':
          {'user<-items':
            {'.userid': 'user.userid',
             '.created': 'user.created',
             '.email': 'user.email',
             '.email@href+': 'user.email',
             '.first_name': 'user.first_name',
             '.last_name': 'user.last_name',
             '.profile-link@href': function(arg) {
               return '/users/' + arg.item['__name__'];
             },
             '[data-email-validated]@class': function(arg) {
               console.log(arg.item['email_validated'])
               if (arg.item['email_validated'] == true) return 'glyphicon glyphicon-ok-sign text-success';
               return 'glyphicon glyphicon-question-sign text-warning';
             }
            }
          }
        };
        $('#users').render(response, directive);
      })
    })
  </script>

  <h1 i18n:translate="">Showing <tal:ts content="len(context)" i18n:name="num" /> user(s)</h1>

  <table class="table table-responsive table-bordered table-striped table-hover">
    <thead>
      <tr>
        <th i18n:translate="">UserID</th>
        <th i18n:translate="">Email</th>
        <th i18n:translate="">First name</th>
        <th i18n:translate="">Last name</th>
        <th i18n:translate="">Created</th>
      </tr>
    </thead>
    <tbody id="users">
      <tr>
        <td>
          <span data-load-marker>
            <span class="rotate-me glyphicon glyphicon-refresh"></span>
            <tal:ts i18n:translate="">Loading...</tal:ts>
          </span>
          <a class="profile-link">
              <span class="userid"></span>
          </a>
        </td>
        <td class="text-nowrap">
          <span data-email-validated></span>
          <a class="email" href="mailto:"></a>
        </td>
        <td><span class="first_name"></span></td>
        <td><span class="last_name"></span></td>
        <td><span class="created"></span></td>
      </tr>
    </tbody>
  </table>
</div>
</body>
</html>
